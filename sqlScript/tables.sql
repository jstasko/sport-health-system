drop table states_json;
Create table states_json(code char(2),
			doc CLOB,
			 constraint state_json_cons CHECK (doc is json));
insert into states_json(code) values('AF');
insert into states_json(code) values('AX');
insert into states_json(code) values('AL');
insert into states_json(code) values('DZ');
insert into states_json(code) values('AS');
insert into states_json(code) values('AD');
insert into states_json(code) values('AO');
insert into states_json(code) values('AI');
insert into states_json(code) values('AQ');
insert into states_json(code) values('AG');
insert into states_json(code) values('AR');
insert into states_json(code) values('AM');
insert into states_json(code) values('AW');
insert into states_json(code) values('AU');
insert into states_json(code) values('AT');
insert into states_json(code) values('AZ');
insert into states_json(code) values('BS');
insert into states_json(code) values('BH');
insert into states_json(code) values('BD');
insert into states_json(code) values('BB');
insert into states_json(code) values('BY');
insert into states_json(code) values('BE');
insert into states_json(code) values('BZ');
insert into states_json(code) values('BJ');
insert into states_json(code) values('BM');
insert into states_json(code) values('BT');
insert into states_json(code) values('BO');
insert into states_json(code) values('BQ');
insert into states_json(code) values('BA');
insert into states_json(code) values('BW');
insert into states_json(code) values('BV');
insert into states_json(code) values('BR');
insert into states_json(code) values('IO');
insert into states_json(code) values('BN');
insert into states_json(code) values('BG');
insert into states_json(code) values('BF');
insert into states_json(code) values('BI');
insert into states_json(code) values('CV');
insert into states_json(code) values('KH');
insert into states_json(code) values('CM');
insert into states_json(code) values('CA');
insert into states_json(code) values('KY');
insert into states_json(code) values('CF');
insert into states_json(code) values('TD');
insert into states_json(code) values('CL');
insert into states_json(code) values('CN');
insert into states_json(code) values('CX');
insert into states_json(code) values('CC');
insert into states_json(code) values('CO');
insert into states_json(code) values('KM');
insert into states_json(code) values('CD');
insert into states_json(code) values('CG');
insert into states_json(code) values('CK');
insert into states_json(code) values('CR');
insert into states_json(code) values('CI');
insert into states_json(code) values('HR');
insert into states_json(code) values('CU');
insert into states_json(code) values('CW');
insert into states_json(code) values('CY');
insert into states_json(code) values('CZ');
insert into states_json(code) values('DK');
insert into states_json(code) values('DJ');
insert into states_json(code) values('DM');
insert into states_json(code) values('DO');
insert into states_json(code) values('EC');
insert into states_json(code) values('EG');
insert into states_json(code) values('SV');
insert into states_json(code) values('GQ');
insert into states_json(code) values('ER');
insert into states_json(code) values('EE');
insert into states_json(code) values('SZ');
insert into states_json(code) values('ET');
insert into states_json(code) values('FK');
insert into states_json(code) values('FO');
insert into states_json(code) values('FJ');
insert into states_json(code) values('FI');
insert into states_json(code) values('FR');
insert into states_json(code) values('GF');
insert into states_json(code) values('PF');
insert into states_json(code) values('TF');
insert into states_json(code) values('GA');
insert into states_json(code) values('GM');
insert into states_json(code) values('GE');
insert into states_json(code) values('DE');
insert into states_json(code) values('GH');
insert into states_json(code) values('GI');
insert into states_json(code) values('GR');
insert into states_json(code) values('GL');
insert into states_json(code) values('GD');
insert into states_json(code) values('GP');
insert into states_json(code) values('GU');
insert into states_json(code) values('GT');
insert into states_json(code) values('GG');
insert into states_json(code) values('GN');
insert into states_json(code) values('GW');
insert into states_json(code) values('GY');
insert into states_json(code) values('HT');
insert into states_json(code) values('HM');
insert into states_json(code) values('VA');
insert into states_json(code) values('HN');
insert into states_json(code) values('HK');
insert into states_json(code) values('HU');
insert into states_json(code) values('IS');
insert into states_json(code) values('IN');
insert into states_json(code) values('ID');
insert into states_json(code) values('IR');
insert into states_json(code) values('IQ');
insert into states_json(code) values('IE');
insert into states_json(code) values('IM');
insert into states_json(code) values('IL');
insert into states_json(code) values('IT');
insert into states_json(code) values('JM');
insert into states_json(code) values('JP');
insert into states_json(code) values('JE');
insert into states_json(code) values('JO');
insert into states_json(code) values('KZ');
insert into states_json(code) values('KE');
insert into states_json(code) values('KI');
insert into states_json(code) values('KP');
insert into states_json(code) values('KR');
insert into states_json(code) values('KW');
insert into states_json(code) values('KG');
insert into states_json(code) values('LA');
insert into states_json(code) values('LV');
insert into states_json(code) values('LB');
insert into states_json(code) values('LS');
insert into states_json(code) values('LR');
insert into states_json(code) values('LY');
insert into states_json(code) values('LI');
insert into states_json(code) values('LT');
insert into states_json(code) values('LU');
insert into states_json(code) values('MO');
insert into states_json(code) values('MK');
insert into states_json(code) values('MG');
insert into states_json(code) values('MW');
insert into states_json(code) values('MY');
insert into states_json(code) values('MV');
insert into states_json(code) values('ML');
insert into states_json(code) values('MT');
insert into states_json(code) values('MH');
insert into states_json(code) values('MQ');
insert into states_json(code) values('MR');
insert into states_json(code) values('MU');
insert into states_json(code) values('YT');
insert into states_json(code) values('MX');
insert into states_json(code) values('FM');
insert into states_json(code) values('MD');
insert into states_json(code) values('MC');
insert into states_json(code) values('MN');
insert into states_json(code) values('ME');
insert into states_json(code) values('MS');
insert into states_json(code) values('MA');
insert into states_json(code) values('MZ');
insert into states_json(code) values('MM');
insert into states_json(code) values('NA');
insert into states_json(code) values('NR');
insert into states_json(code) values('NP');
insert into states_json(code) values('NL');
insert into states_json(code) values('NC');
insert into states_json(code) values('NZ');
insert into states_json(code) values('NI');
insert into states_json(code) values('NE');
insert into states_json(code) values('NG');
insert into states_json(code) values('NU');
insert into states_json(code) values('NF');
insert into states_json(code) values('MP');
insert into states_json(code) values('NO');
insert into states_json(code) values('OM');
insert into states_json(code) values('PK');
insert into states_json(code) values('PW');
insert into states_json(code) values('PS');
insert into states_json(code) values('PA');
insert into states_json(code) values('PG');
insert into states_json(code) values('PY');
insert into states_json(code) values('PE');
insert into states_json(code) values('PH');
insert into states_json(code) values('PN');
insert into states_json(code) values('PL');
insert into states_json(code) values('PT');
insert into states_json(code) values('PR');
insert into states_json(code) values('QA');
insert into states_json(code) values('RE');
insert into states_json(code) values('RO');
insert into states_json(code) values('RU');
insert into states_json(code) values('RW');
insert into states_json(code) values('BL');
insert into states_json(code) values('SH');
insert into states_json(code) values('KN');
insert into states_json(code) values('LC');
insert into states_json(code) values('MF');
insert into states_json(code) values('PM');
insert into states_json(code) values('VC');
insert into states_json(code) values('WS');
insert into states_json(code) values('SM');
insert into states_json(code) values('ST');
insert into states_json(code) values('SA');
insert into states_json(code) values('SN');
insert into states_json(code) values('RS');
insert into states_json(code) values('SC');
insert into states_json(code) values('SL');
insert into states_json(code) values('SG');
insert into states_json(code) values('SX');
insert into states_json(code) values('SK');
insert into states_json(code) values('SI');
insert into states_json(code) values('SB');
insert into states_json(code) values('SO');
insert into states_json(code) values('ZA');
insert into states_json(code) values('GS');
insert into states_json(code) values('SS');
insert into states_json(code) values('ES');
insert into states_json(code) values('LK');
insert into states_json(code) values('SD');
insert into states_json(code) values('SR');
insert into states_json(code) values('SJ');
insert into states_json(code) values('SE');
insert into states_json(code) values('CH');
insert into states_json(code) values('SY');
insert into states_json(code) values('TW');
insert into states_json(code) values('TJ');
insert into states_json(code) values('TZ');
insert into states_json(code) values('TH');
insert into states_json(code) values('TL');
insert into states_json(code) values('TG');
insert into states_json(code) values('TK');
insert into states_json(code) values('TO');
insert into states_json(code) values('TT');
insert into states_json(code) values('TN');
insert into states_json(code) values('TR');
insert into states_json(code) values('TM');
insert into states_json(code) values('TC');
insert into states_json(code) values('TV');
insert into states_json(code) values('UG');
insert into states_json(code) values('UA');
insert into states_json(code) values('AE');
insert into states_json(code) values('GB');
insert into states_json(code) values('UM');
insert into states_json(code) values('US');
insert into states_json(code) values('UY');
insert into states_json(code) values('UZ');
insert into states_json(code) values('VU');
insert into states_json(code) values('VE');
insert into states_json(code) values('VN');
insert into states_json(code) values('VG');
insert into states_json(code) values('VI');
insert into states_json(code) values('WF');
insert into states_json(code) values('EH');
insert into states_json(code) values('YE');
insert into states_json(code) values('ZM');
insert into states_json(code) values('ZW');

DECLARE
    cursor cur_state is (select code, sys.json_web_service_geo(code) as json from states_json) for update;
begin
    for riadok in cur_state
        loop
            update states_json set doc=riadok.json where current of cur_state;
        end loop;
    commit;
end;
/

select sys.json_web_service_geo('AD') from dual;
create table m_krajina as
 select jt.id, jt.n_krajiny
  from states_json s,
  json_table(s.doc, '$.geonames[0]'
    columns(
        id varchar2(2) path '$.countryCode',
        n_krajiny varchar2(30) path '$.countryName'
    )
  ) jt;

alter table m_krajina add constraint id primary key (id);


create table m_kraj
(
 n_kraja    varchar2(45) NOT NULL ,
 id_krajiny varchar2(2) NOT NULL ,
 id int NOT NULL ,

PRIMARY KEY (id),
CONSTRAINT cons_kraj_krajina_fk  FOREIGN KEY (id_krajiny) REFERENCES m_krajina (id)
);
/*
CREATE SEQUENCE m_kraj_seq;

CREATE OR REPLACE TRIGGER m_kraj_on_insert
  BEFORE INSERT ON m_kraj
  FOR EACH ROW
BEGIN
  SELECT m_kraj_seq.nextval
  INTO :new.id
  FROM dual;
END;
/
*/
create table m_okres
(
 n_okresu  varchar2(45) NOT NULL ,
 id        int NOT NULL ,
 id_kraja int NOT NULL ,

PRIMARY KEY (id),
CONSTRAINT cons_okres_kraj_fk FOREIGN KEY (id_kraja) REFERENCES m_kraj (id)
);
/*
CREATE SEQUENCE m_okres_seq;

CREATE OR REPLACE TRIGGER m_okres_on_insert
  BEFORE INSERT ON m_okres
  FOR EACH ROW
BEGIN
  SELECT m_okres_seq.nextval
  INTO :new.id
  FROM dual;
END;
/
*/

create table m_adresa
(
 n_mesta       varchar2(45) NOT NULL ,
 --ulica         varchar(45) NOT NULL , TODO DAL SOM PREC
 cislo_domu    varchar2(45) NULL ,
 --popisne_cislo varchar(45) NULL , TODO ROVNAKE AKO cislo_domu
 id_okresu     int NOT NULL ,
 PSC           char(10) NOT NULL ,
 id            integer not null,

PRIMARY KEY (id),
CONSTRAINT cons_adresa_okres_fk FOREIGN KEY (id_okresu) REFERENCES m_okres (id)
);

CREATE SEQUENCE m_adresa_seq;

CREATE OR REPLACE TRIGGER m_adresa_on_insert
  BEFORE INSERT ON m_adresa
  FOR EACH ROW
BEGIN
  SELECT m_adresa_seq.nextval
  INTO :new.id
  FROM dual;
END;
/

create table m_vyrobca_liekov
(
 id_adresa         integer NOT NULL ,
 nazov             varchar2(90) NOT NULL ,
 id                int NOT NULL ,

PRIMARY KEY (id),
CONSTRAINT cons_vl_adresa_fk FOREIGN KEY (id_adresa) REFERENCES m_adresa (id)
);

create table m_liek
(
 id_vyrobca_liekov int NOT NULL ,
 nazov             varchar2(500) NOT NULL ,
 popis             varchar2(200) NULL ,
 id                int NOT NULL ,

PRIMARY KEY (id),
CONSTRAINT cons_liek_vk_fk FOREIGN KEY (id_vyrobca_liekov) REFERENCES m_vyrobca_liekov (id)
);

CREATE SEQUENCE m_liek_seq;

CREATE OR REPLACE TRIGGER m_liek_on_insert
  BEFORE INSERT ON m_liek
  FOR EACH ROW
BEGIN
  SELECT m_liek_seq.nextval
  INTO :new.id
  FROM dual;
END;
/

create table m_lekaren
(
 id_adresa  integer NOT NULL ,
 nazov      varchar2(200) NOT NULL ,
 id         int NOT NULL ,

PRIMARY KEY (id),
CONSTRAINT cons_lekaren_mesto_fk FOREIGN KEY (id_adresa) REFERENCES m_adresa (id)
);

CREATE SEQUENCE m_lekaren_seq;

CREATE OR REPLACE TRIGGER m_lekaren_on_insert
  BEFORE INSERT ON m_lekaren
  FOR EACH ROW
BEGIN
  SELECT m_lekaren_seq.nextval
  INTO :new.id
  FROM dual;
END;
/

create table m_institut
(
 id_adresa   integer NOT NULL ,
 nazov       varchar2(500) NOT NULL ,
 popis       varchar2(200) NULL ,
 id          int NOT NULL ,

PRIMARY KEY (id),
CONSTRAINT cons_institut_mesto_fk FOREIGN KEY (id_adresa) REFERENCES m_adresa (id)
);
/

CREATE SEQUENCE m_id_institut_seq;

CREATE OR REPLACE TRIGGER m_institut_on_insert
  BEFORE INSERT ON m_institut
  FOR EACH ROW
BEGIN
  SELECT m_id_institut_seq.nextval
  INTO :new.id
  FROM dual;
END;
/

create table m_liecba
(
 id_liek     int NOT NULL ,
 id_lekaren  int NOT NULL ,
 id_institut int NOT NULL ,
 stav        varchar2(45) NOT NULL ,
 cena        float(10) NOT NULL,
 id          int NOT NULL ,

PRIMARY KEY (id),
CONSTRAINT cons_liecba_institut_fk FOREIGN KEY (id_institut) REFERENCES m_institut (id),
CONSTRAINT cons_liecba_liek_fk FOREIGN KEY (id_liek) REFERENCES m_liek (id),
CONSTRAINT cons_liecba_lekaren_l FOREIGN KEY (id_lekaren) REFERENCES m_lekaren (id)
);

CREATE SEQUENCE m_liecba_seq;

CREATE OR REPLACE TRIGGER m_liecba_on_insert
  BEFORE INSERT ON m_liecba
  FOR EACH ROW
BEGIN
  SELECT m_liecba_seq.nextval
  INTO :new.id
  FROM dual;
END;
/

create table m_hrac
(
 meno       varchar2(45) NOT NULL ,
 priezvisko varchar2(45) NOT NULL ,
 id         char(40) NOT NULL ,

PRIMARY KEY (id)
);

create table m_operacia
(
 nazov       varchar2(500) NOT NULL ,
 popis       varchar2(200)  NULL ,
 id          int NOT NULL ,

PRIMARY KEY (id)
);

CREATE SEQUENCE m_operacia_seq;

CREATE OR REPLACE TRIGGER m_operacia_on_insert
  BEFORE INSERT ON m_operacia
  FOR EACH ROW
BEGIN
  SELECT m_operacia_seq.nextval
  INTO :new.id
  FROM dual;
END;
/

CREATE TABLE m_image
(
 id         integer NOT NULL ,
 file_size  integer NOT NULL ,
 mime_type  varchar2(45) NOT NULL ,
 created    timestamp NOT NULL ,
 avatar     blob NOT NULL ,
 other_data varchar2(45) NULL ,

PRIMARY KEY (id)
);

CREATE SEQUENCE m_image_id_seq;

CREATE OR REPLACE TRIGGER m_image_on_insert
    BEFORE INSERT ON M_IMAGE
    FOR EACH ROW
BEGIN
    SELECT m_image_id_seq.nextval
    INTO :new.id
    FROM dual;
END;
/


create table m_pouzivatel
(
 email                    varchar2(45) NOT NULL ,
 heslo                    varchar2(450) NOT NULL ,
 datum_posled_prihlasenia timestamp NOT NULL ,
 datum_registracie        timestamp NOT NULL ,
 id_image                 integer NULL,
 PRIMARY KEY (email),
 CONSTRAINT cons_m_pouzivatel_fk FOREIGN KEY (id_image) REFERENCES m_image (id)
);

create table m_osoba
(
 ExterneID      char(40) NULL ,
 email          varchar2(45) NULL ,
 rod_cislo      char(11) NOT NULL ,
 meno           varchar2(70) null,
 priezvisko     varchar2(70) null,
PRIMARY KEY (rod_cislo),
CONSTRAINT cons_osoba_hrac_fk FOREIGN KEY (ExterneID) REFERENCES m_hrac (id),
CONSTRAINT cons_osoba_pouzivatel_fk FOREIGN KEY (email) REFERENCES m_pouzivatel (email)
);

create table m_poistovna
(
 rod_cislo       char(11) NULL , --TODO podla mna moze byt null
 nazov_poistovne varchar2(100) NOT NULL ,
 id              int NOT NULL ,

PRIMARY KEY (id),
CONSTRAINT cons_poistovna_osoba_fk FOREIGN KEY (rod_cislo) REFERENCES m_osoba (rod_cislo)
);

create table m_specializacia
(
 nazov            varchar2(100) NOT NULL ,
 popis            varchar2(200) NULL ,
 id               int NOT NULL ,
PRIMARY KEY (id)
);

CREATE SEQUENCE m_specializacia_seq;

CREATE OR REPLACE TRIGGER m_specializacia_on_insert
  BEFORE INSERT ON m_specializacia
  FOR EACH ROW
BEGIN
  SELECT m_specializacia_seq.nextval
  INTO :new.id
  FROM dual;
END;
/

create or replace type m_krv as object
(
  typ_skupiny      varchar2(3),
  rh_faktor        varchar2(3)
)
/

create table m_krvna_skupina(
  rod_cislo        char(11) NOT NULL ,
  auto             m_krv,
  id               int NOT NULL ,
  PRIMARY KEY (id),
  CONSTRAINT cons_ks_osoba_fk FOREIGN KEY (rod_cislo) REFERENCES m_osoba (rod_cislo)
)
/

CREATE SEQUENCE m_krvna_skupina_seq;

CREATE OR REPLACE TRIGGER m_krvna_skupina_on_insert
  BEFORE INSERT ON m_krvna_skupina
  FOR EACH ROW
BEGIN
  SELECT m_krvna_skupina_seq.nextval
  INTO :new.id
  FROM dual;
END;
/


create or replace type m_vlastnosti as object
(
 hmotnost           float(10),
 vyska              float(10)
)
/

create table m_vlastnosti_hraca
(
 rod_cislo          char(11) NOT NULL ,
 auto               m_vlastnosti,
 id                 int NOT NULL ,

PRIMARY KEY (id),
CONSTRAINT cons_vh_osoba_fk FOREIGN KEY (rod_cislo) REFERENCES m_osoba (rod_cislo)
)
/

CREATE SEQUENCE m_vlastnosti_hraca_seq;

CREATE OR REPLACE TRIGGER m_vlastnosti_hraca_on_insert
  BEFORE INSERT ON m_vlastnosti_hraca
  FOR EACH ROW
BEGIN
  SELECT m_vlastnosti_hraca_seq.nextval
  INTO :new.id
  FROM dual;
END;
/



create table m_doktor
(
 rod_cislo  char(11) NOT NULL ,
 meno       varchar2(45),
 priezvisko varchar2(45),
 id_image   integer NULL,
 id         char(11) NOT NULL ,
PRIMARY KEY (id),
CONSTRAINT cons_doktor_iamge_fk FOREIGN KEY (id_image) REFERENCES m_image (id),
CONSTRAINT cons_doktor_osoba_fk FOREIGN KEY (rod_cislo) REFERENCES m_osoba (rod_cislo)
);



create table m_specializacia_lekara
(
 id_doktor               char(11) NOT NULL ,
 id_specializacia        int NOT NULL ,
 id                      int NOT NULL ,

PRIMARY KEY (id),
CONSTRAINT cons_sl_doktor_fk FOREIGN KEY (id_doktor) REFERENCES m_doktor (id),
CONSTRAINT cons_sl_specializacia_fk FOREIGN KEY (id_specializacia) REFERENCES m_specializacia (id)
);

CREATE SEQUENCE m_specializacia_lekara_seq;

CREATE OR REPLACE TRIGGER m_specializacia_lekara_on_insert
  BEFORE INSERT ON m_specializacia_lekara
  FOR EACH ROW
BEGIN
  SELECT m_specializacia_lekara_seq.nextval
  INTO :new.id
  FROM dual;
END;
/



create or replace type m_rec_choroba as object
(
  popis      varchar2(500),
  nazov      varchar2(45),
  kod        varchar2(6)
)
/

create or replace type m_t_choroba is table of m_rec_choroba;
/

create table m_zdravotna_karta
(
 rod_cislo                  char(11) not NULL ,
 m_t_choroby_informacie     m_t_choroba,
 kontraindikacie            varchar2(200) NULL ,
 datum_zalozenia            timestamp NULL ,  --TODO BECAUSE OF GENERATED INSERT
 id                         int not NULL ,

PRIMARY KEY (id),
CONSTRAINT cons_zk_osoba_fk FOREIGN KEY (rod_cislo) REFERENCES m_osoba (rod_cislo)
)
nested table m_t_choroby_informacie store as informacie_nest_tab;
/

CREATE SEQUENCE m_zdravotna_karta_seq;

CREATE OR REPLACE TRIGGER m_zdravotna_karta_on_insert
  BEFORE INSERT ON m_zdravotna_karta
  FOR EACH ROW
BEGIN
  SELECT m_zdravotna_karta_seq.nextval
  INTO :new.id
  FROM dual;
END;
/

create table m_adresa_hraca
(
 id_adresa       integer NOT NULL ,
 rod_cislo       char(11) NOT NULL ,
 id              int NOT NULL ,

PRIMARY KEY (id),
CONSTRAINT cons_ah_adresa_fk  FOREIGN KEY (id_adresa) REFERENCES m_adresa (id),
CONSTRAINT cons_ah_osoba_fk FOREIGN KEY (rod_cislo) REFERENCES m_osoba (rod_cislo)
);
create table m_zdravotny_zaznam
(
 id_doktor           char(11) NOT NULL ,
 rod_cislo           char(11) NOT NULL ,
 id_zdravotny_karta int not NULL ,
 id_institut         int NOT NULL ,
 datum_prehliadky    timestamp NULL , --TODO BECAUSE OF GENERATED INSERT
 stav                varchar2(100) NULL ,
 id                  int NOT NULL ,

PRIMARY KEY (id),
CONSTRAINT cons_zz_doktor_fk FOREIGN KEY (id_doktor) REFERENCES m_doktor (id),
CONSTRAINT cons_zz_osoba_fk FOREIGN KEY (rod_cislo) REFERENCES m_osoba (rod_cislo),
CONSTRAINT cons_zz_institut_fk FOREIGN KEY (id_institut) REFERENCES m_institut (id),
CONSTRAINT cons_zz_id_zdravotny_zaznam_fk FOREIGN KEY (id_zdravotny_karta) REFERENCES m_zdravotna_karta (id)
);

CREATE SEQUENCE m_zdravotny_zaznam_seq;

CREATE OR REPLACE TRIGGER m_zdravotny_zaznam_on_insert
  BEFORE INSERT ON m_zdravotny_zaznam
  FOR EACH ROW
BEGIN
  SELECT m_zdravotny_zaznam_seq.nextval
  INTO :new.id
  FROM dual;
END;
/

CREATE SEQUENCE m_adresa_hraca_seq;

CREATE OR REPLACE TRIGGER m_adresa_hraca_on_insert
  BEFORE INSERT ON m_adresa_hraca
  FOR EACH ROW
BEGIN
  SELECT m_adresa_hraca_seq.nextval
  INTO :new.id
  FROM dual;
END;
/

create table m_osetrujuci_doktor
(
 id_institut          int NOT NULL ,
 id_doktor            char(11) NOT NULL ,
 id                   int NOT NULL ,

PRIMARY KEY (id),
CONSTRAINT cons_od_institut_fk FOREIGN KEY (id_institut) REFERENCES m_institut (id),
CONSTRAINT cons_od_doktor_fk FOREIGN KEY (id_doktor) REFERENCES m_doktor (id)
);

CREATE SEQUENCE m_osetrujuci_doktor_seq;

CREATE OR REPLACE TRIGGER m_osetrujuci_doktor_on_insert
  BEFORE INSERT ON m_osetrujuci_doktor
  FOR EACH ROW
BEGIN
  SELECT m_osetrujuci_doktor_seq.nextval
  INTO :new.id
  FROM dual;
END;
/

create table m_operacie_pacienta
(
 rod_cislo            char(11) NOT NULL ,
 id_operacia          int NOT NULL ,
 id_osetrujuci_doktor int NOT NULL ,
 popis                varchar2(200) NULL ,
 id                   int NOT NULL ,

PRIMARY KEY (id),
CONSTRAINT cons_op_osoba_fk FOREIGN KEY (rod_cislo) REFERENCES m_osoba (rod_cislo),
CONSTRAINT cons_op_operacia_fk FOREIGN KEY (id_operacia) REFERENCES m_operacia (id),
CONSTRAINT cons_op_od_fk FOREIGN KEY (id_osetrujuci_doktor) REFERENCES m_osetrujuci_doktor (id)
);

CREATE SEQUENCE m_operacie_pacienta_seq;

CREATE OR REPLACE TRIGGER m_operacie_pacienta_on_insert
  BEFORE INSERT ON m_operacie_pacienta
  FOR EACH ROW
BEGIN
  SELECT m_operacie_pacienta_seq.nextval
  INTO :new.id
  FROM dual;
END;
/

create table m_predpisana_liecba
(
 id_zdravotna_kara    int NOT NULL ,
 id_liecba            int NOT NULL ,
 id                   int NOT NULL ,

PRIMARY KEY (id),
CONSTRAINT cons_pl_liecba_fk FOREIGN KEY (id_liecba) REFERENCES m_liecba (id),
CONSTRAINT cons_pl_zk_fk FOREIGN KEY (id_zdravotna_kara) REFERENCES m_zdravotna_karta (id)
);


CREATE SEQUENCE m_predpisana_liecba_seq;

CREATE OR REPLACE TRIGGER m_predpisana_liecba_on_insert
  BEFORE INSERT ON m_predpisana_liecba
  FOR EACH ROW
BEGIN
  SELECT m_predpisana_liecba_seq.nextval
  INTO :new.id
  FROM dual;
END;
/

--http://www.dba-oracle.com/t_oracle_create_directory.htm TODO KOMUNIKACIA
--create directory m_images_stasko_pdbs_dir as 'c:/Images/';

